#!/usr/bin/env bash

# Installs Spigot, if necessary
function bootstrap {
    echo "0"
    exit 0
}

case $1 in

    "start")
        echo "Checking Spigot installation status..."
        spigot_version=$(/bin/bash /usr/local/spigot/spigot_version.sh)

        echo "Spigot version: "
        echo "$spigot_version"

        if [ "$(spigot_version)" = "NONE" ]
        then
            echo "Spigot is not installed. Installing now..."
            /bin/bash /usr/local/spigot/spigot_install.sh
        fi

        echo "Starting Spigot server..."
        if [ "$(bootstrap)" = "0" ]
        then
            echo "Waiting!"
            numseconds=$(/bin/bash /usr/local/spigot/spigot_start.sh)
            wait
            sleep "$numseconds"
            echo "Done!"
            exit $?
        fi
    ;;

    "stop")
        echo "Stop"
    ;;

    *)
        echo "Unrecognized command"
    ;;
esac

exit 0
